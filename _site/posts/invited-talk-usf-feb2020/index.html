<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="gregers kjerulf dubrow">
<meta name="dcterms.date" content="2021-02-26">

<title>gregers kjerulf dubrow - Invited Talk at University of San Francisco, February 2020</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/plain" cookie-consent="tracking">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-157557326-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"express",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="gregers kjerulf dubrow - Invited Talk at University of San Francisco, February 2020">
<meta property="og:description" content="[]">
<meta property="og:image" content="https://www.gregdubrow.io/posts/invited-talk-usf-feb2020/usanfranlogo.jpg">
<meta property="og:site-name" content="gregers kjerulf dubrow">
<meta name="twitter:title" content="gregers kjerulf dubrow - Invited Talk at University of San Francisco, February 2020">
<meta name="twitter:description" content="[]">
<meta name="twitter:image" content="https://www.gregdubrow.io/posts/invited-talk-usf-feb2020/usanfranlogo.jpg">
<meta name="twitter:creator" content="@greg_dubrow">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">gregers kjerulf dubrow</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/greg-dubrow"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/dubrowg/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/greg_dubrow"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Invited Talk at University of San Francisco, February 2020</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">post</div>
                <div class="quarto-category">tidytuesday</div>
                <div class="quarto-category">rstats</div>
                <div class="quarto-category">ggplot</div>
                <div class="quarto-category">dataviz</div>
                <div class="quarto-category">data visualization</div>
                <div class="quarto-category">higher education</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>gregers kjerulf dubrow </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 26, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>[<img src="usanfranlogo.jpg" class="img-fluid" data-fig-align="left">]</p>
<p>In early 2020 (back in the days of in-person gatherings) I was invited to give a talk at two budget forums at the <a href="https://www.usfca.edu/">University of San Francisco</a>. The general theme was looking at the landscape of enrollments in higher education, with a specific focus on liberal arts colleges, especially Jesuit colleges. Because I collected data from a variety of sources and did much of the work in r, I thought it would make for a good data blog post. Plus, like the <a href="https://www.gregdubrow.io/2021/02/25/tidy-tuesday-february-2-20201-hbcu-enrollment/">Tidy Tuesday HBCU enrollment post</a>, it’s about higher education, which has been my area of professional expertise for a while now.</p>
<p>I structured the talk around these general questions:</p>
<section id="what-are-the-major-trends-affecting-the-higher-education-landscape-in-the-us-today-particularly-traditional-liberal-arts-colleges" class="level3">
<h3 class="anchored" data-anchor-id="what-are-the-major-trends-affecting-the-higher-education-landscape-in-the-us-today-particularly-traditional-liberal-arts-colleges">What are the major trends affecting the higher education landscape in the US today, particularly traditional liberal arts colleges?</h3>
<ul>
<li>Changing demographics impacting enrollments</li>
<li>Affordability<br>
</li>
<li>What social/political threats are on the horizon that colleges should start addressing?</li>
</ul>
<p>The talk was divided into four segments:</p>
<ul>
<li>The high school graduation picture in California (USF gets most of its students from CA)</li>
<li>Historical enrollment at USF, and compared to other Jesuit colleges</li>
<li>College Costs and Affordability<br>
</li>
<li>What social/political threats are on the horizon that colleges should start addressing?</li>
</ul>
<p>The data, code and resulting presentation are in this <a href="https://github.com/greg-dubrow/USF-talk-February-2020">github repo</a>. What I plan to do in this post is in effect annotate some of the code to explain how I put everything together. And of course to show some charts &amp; tables.</p>
<p>First up is pulling in a few decades of high school graduation and enrollment data and wrangling it all to show historical enrollment and projections through 2029. The full code for that is at the github repo in the file <a href="https://github.com/greg-dubrow/USF-talk-February-2020/blob/master/01_hs%20enrollment%20data.R">01_hs enrollment data.R</a>. So what did I do?</p>
<p>First, loaded some packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># to do tidyverse things</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidylog) <span class="co"># to get a log of what's happening to the data</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># to stitch together plots</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext) <span class="co"># helper functions for ggplot text</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel) <span class="co"># helper functions for ggplot</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rCAEDDATA) <span class="co"># aggregated CA HS data</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co"># read in flat files</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) <span class="co"># data munging/cleaning utilities</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <a href="https://github.com/daranzolin/rCAEDDATA">rCAEDDATA package</a> was put together by my former <a href="https://ir.sfsu.edu/">SFSU IR</a> colleague <a href="https://daranzolin.github.io/">David Ranzolin</a>. Though the last update was October 2017, it still contains a trove of data, including public HS graduation numbers from 1993 to 2016. That said, I didn’t actually use the package functions, just downloaded the data included with the package. For later years I manually downloaded files from the CA Department of Education’s data pages: <a href="https://www.cde.ca.gov/ds/sd/sd/filesgrad.asp">2017 here</a>, and the <a href="https://www.cde.ca.gov/ds/sd/sd/filesfycgr.asp">later years here</a>. The 2017 file has the same structure as the files in David’s package. Later years need a bit of restructuring:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>cahsgrad18 <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"data/cahsgrad18.txt"</span>, <span class="at">stringsAsFactors=</span><span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(reporting_category <span class="sc">==</span> <span class="st">"TA"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(aggregate_level <span class="sc">==</span> <span class="st">"S"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dass <span class="sc">==</span> <span class="st">"All"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(charter_school <span class="sc">==</span> <span class="st">"All"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="st">"2018"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="fu">factor</span>(YEAR)) <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">ends_with</span>(<span class="st">"_code"</span>)), as.character) <span class="sc">%&gt;%</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">county_code =</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(county_code) <span class="sc">==</span> <span class="dv">1</span>, </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">str_pad</span>(county_code, <span class="dv">2</span>, <span class="st">"left"</span>, <span class="st">"0"</span>), county_code)) <span class="sc">%&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">CDS_CODE =</span> <span class="fu">paste</span>(county_code, district_code, school_code, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">GRADS =</span> <span class="fu">as.integer</span>(<span class="fu">ifelse</span>(regular_hs_diploma_graduates_count <span class="sc">==</span> <span class="st">"*"</span>, </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span>, regular_hs_diploma_graduates_count))) <span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">UC_GRADS =</span> <span class="fu">as.integer</span>(<span class="fu">ifelse</span>(met_uc_csu_grad_req_s_count <span class="sc">==</span> <span class="st">"*"</span>, </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                <span class="dv">0</span>, met_uc_csu_grad_req_s_count))) <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(CDS_CODE, GRADS, UC_GRADS, YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total_grads =</span> <span class="fu">sum</span>(GRADS),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">uccsu =</span> <span class="fu">sum</span>(UC_GRADS),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">notuccsu =</span> total_grads <span class="sc">-</span> uccsu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, some projected HS graduation data from the <a href="https://www.dof.ca.gov/Forecasting/Demographics/Projections/Public_K-12_Graded_Enrollment/">CA Department of Finance</a>. I did a quick transposing of the “HS Grads Table” tab in excel and used that to read into r. You can see the file I used at the github repo’s <a href="https://github.com/greg-dubrow/USF-talk-February-2020/tree/master/data">data folder</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>grproj_to2028 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/capublic_k12_enrollproj_to2028.xlsx"</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sheet =</span> <span class="st">"hsgrads-tr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">!=</span> <span class="st">"2017-18"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">yearend =</span> <span class="fu">str_sub</span>(year, <span class="dv">6</span>, <span class="dv">7</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">YEAR =</span> <span class="fu">paste</span>(<span class="st">"20"</span>, yearend, <span class="at">sep =</span> <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#mutate(YEAR = factor(year_ch)) %&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">uccsu =</span> <span class="fu">as.integer</span>(<span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">notuccsu =</span> <span class="fu">as.integer</span>(<span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">notuccsu =</span> <span class="fu">as.integer</span>(<span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"Projected"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(YEAR, <span class="at">total_grads =</span> total, uccsu, notuccsu, type) <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># amend 2018-19 with actual results from</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># https://dq.cde.ca.gov/dataquest/dqcensus/CohRateLevels.aspx?cds=00&amp;agglevel=state&amp;year=2018-19</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">total_grads =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2019"</span>, <span class="dv">417496</span>, total_grads)) <span class="sc">%&gt;%</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">uccsu =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2019"</span>, <span class="dv">210980</span>, uccsu)) <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">notuccsu =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2019"</span>, total_grads <span class="sc">-</span> uccsu, notuccsu)) <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2019"</span>, <span class="st">"Actual"</span>, type))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The projected HS grad stats didn’t have values for UC/CSU grads, so I needed to impute that as part of the merging of the actual &amp; projected files. I also calculated year-over-year percent changes for a few fields. (though I did it manually not with a function like in the <a href="https://www.gregdubrow.io/posts/tidy-tuesday-feb-02-2021-hbcu/">Tidy Tuesday HBCU post</a>). The code below gets us the <code>cahsgrads_1993_2028</code> dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cahsgrads_1993_2028 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cahsgrad93to18_tot, grproj_to2028) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> uccsu <span class="sc">/</span> total_grads) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add projected uccsu grads based on constant 2017-18 to 2018-19 increase 0.0061437</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">&gt;=</span> <span class="st">"2020"</span>, <span class="fu">lag</span>(pctucgrads) <span class="sc">+</span> <span class="fl">0.0061437</span>, pctucgrads)) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2021"</span>, <span class="fu">lag</span>(pctucgrads) <span class="sc">+</span> <span class="fl">0.0061437</span>, pctucgrads)) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2022"</span>, <span class="fu">lag</span>(pctucgrads) <span class="sc">+</span> <span class="fl">0.0061437</span>, pctucgrads)) <span class="sc">%&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2023"</span>, <span class="fu">lag</span>(pctucgrads) <span class="sc">+</span> <span class="fl">0.0061437</span>, pctucgrads)) <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2024"</span>, <span class="fu">lag</span>(pctucgrads) <span class="sc">+</span> <span class="fl">0.0061437</span>, pctucgrads)) <span class="sc">%&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2025"</span>, <span class="fu">lag</span>(pctucgrads) <span class="sc">+</span> <span class="fl">0.0061437</span>, pctucgrads)) <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2026"</span>, <span class="fu">lag</span>(pctucgrads) <span class="sc">+</span> <span class="fl">0.0061437</span>, pctucgrads)) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2027"</span>, <span class="fu">lag</span>(pctucgrads) <span class="sc">+</span> <span class="fl">0.0061437</span>, pctucgrads)) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2028"</span>, <span class="fu">lag</span>(pctucgrads) <span class="sc">+</span> <span class="fl">0.0061437</span>, pctucgrads)) <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> <span class="fu">ifelse</span>(YEAR <span class="sc">==</span> <span class="st">"2029"</span>, <span class="fu">lag</span>(pctucgrads) <span class="sc">+</span> <span class="fl">0.0061437</span>, pctucgrads)) <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">uccsu =</span> <span class="fu">ifelse</span>(type <span class="sc">==</span> <span class="st">"Projected"</span>, <span class="fu">round</span>(pctucgrads <span class="sc">*</span> total_grads, <span class="dv">0</span>), uccsu)) <span class="sc">%&gt;%</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">notuccsu =</span> <span class="fu">ifelse</span>(type <span class="sc">==</span> <span class="st">"Projected"</span>, <span class="fu">round</span>(total_grads <span class="sc">-</span>uccsu, <span class="dv">0</span>), notuccsu)) <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gr_tot_change =</span> (total_grads <span class="sc">-</span> <span class="fu">lag</span>(total_grads))) <span class="sc">%&gt;%</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gr_tot_pct_change =</span> (total_grads<span class="sc">/</span><span class="fu">lag</span>(total_grads)<span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gr_uc_change =</span> (uccsu <span class="sc">-</span> <span class="fu">lag</span>(uccsu))) <span class="sc">%&gt;%</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gr_uc_pct_change =</span> (uccsu<span class="sc">/</span><span class="fu">lag</span>(uccsu) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gr_notuc_change =</span> (notuccsu <span class="sc">-</span> <span class="fu">lag</span>(notuccsu))) <span class="sc">%&gt;%</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">gr_notuc_pct_change =</span> (notuccsu<span class="sc">/</span><span class="fu">lag</span>(notuccsu) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(YEAR, total_grads, uccsu, notuccsu, type, pctucgrads, type, <span class="fu">everything</span>())</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>cahsgrads_1993_2028 <span class="ot">&lt;-</span> cahsgrads_1993_2028 <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pctucgrads =</span> <span class="fu">ifelse</span>(year_ch <span class="sc">&gt;=</span> <span class="st">"9293"</span>, uccsu <span class="sc">/</span> total_grads, pctucgrads))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have the data, let’s make the chart I presented to the group, showing actual &amp; projected high school grads in California, breaking out the <a href="https://www.cde.ca.gov/ci/gs/hs/hsgrtable.asp">UC/CSU eligible</a> grads.</p>
<p>What does the chart tell us? Well…</p>
<ul>
<li>67% increase in grads from 1993 to 2018</li>
<li>UC/CSU eligibility 33% in 1993, 50% in 2018</li>
<li>Grads expected to peak in 2023, then decline slightly</li>
</ul>
<p>But these assumptions were all pre-COVID - I gave the talks in early February of 2020. Given factors such as migration patterns within the state, people moving out of CA, parents moving their kids to private schools, etc., the actual graduation picture is sure to change.</p>
<div class="cell" data-fig.dpi="300">
<details>
<summary>show the enrollment charts code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cahsgrads_1993_2028 <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(YEAR, uccsu, notuccsu) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>YEAR, <span class="at">names_to =</span> <span class="st">"ucelig"</span>, <span class="at">values_to =</span> <span class="st">"n"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(YEAR, n, <span class="at">fill =</span> <span class="fu">rev</span>(ucelig))) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">27.5</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> <span class="fl">27.5</span>, <span class="at">yend =</span> <span class="dv">500000</span>),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">500000</span>)) <span class="sc">+</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"9293"</span>, <span class="st">"9798"</span>, <span class="st">"0203"</span>, <span class="st">"0708"</span>, <span class="st">"1213"</span>, <span class="st">"1718"</span>, <span class="st">"2223"</span>, <span class="st">"2829"</span>)) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1295D8"</span>, <span class="st">"white"</span>),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"UC CSU Eligible"</span>, <span class="st">"Not UC/CSU Elig"</span>)) <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">caption =</span> <span class="st">"Sources: Actual: CA Dept of Education. Projections: CA Dept of Finance"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"UC/CSU Eligible?"</span>) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">28</span>, <span class="at">y =</span> <span class="dv">500000</span>, <span class="at">label =</span> <span class="st">"Projected"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">size =</span> <span class="dv">6</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>, <span class="at">hjust =</span> <span class="sc">-</span>.<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),   <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">9</span>),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>), <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="images/dataviz1-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Next I presented some data on USF enrollment and compared USF to their Jesuit college peers. For that I used two sources: data from the Delta Cost Project (DCP), and since DCP stops at 2015, downloaded some files directly from IPEDS and read in the CSVs. I could also have used r tools like the <a href="https://www.urban.org/">Urban Insitute’s</a> <a href="https://github.com/UrbanInstitute/education-data-package-r"><code>educationdata</code> package</a> an API wrapper to that scrapes NCES and other websites for data. (I also referenced that package in <a href="https://www.gregdubrow.io/posts/tidy-tuesday-feb-02-2021-hbcu/">my HBCU post</a>).</p>
<p>The import code isn’t all that challenging - read in the CSV, select the fields I needed, do a bit of basic cleaning. So no need to show it. You can see it in the github repo - go to the file <a href="https://github.com/greg-dubrow/USF-talk-February-2020/blob/master/02_ipeds%20data_enroll.R">’02_ipeds_enroll.R`</a>. Though if anything’s worth highlighting it’s the need to create an object of IPEDS unitids for Jesuit colleges so I could group them during analysis. The Jesuit colleges include names you know: Georgetown, Gonazaga, Boston College, the Loyolas (Chicago, LA, New Orleans, Baltimore), etc…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>jesids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"164924"</span>, <span class="st">"181002"</span>, <span class="st">"186432"</span>, <span class="st">"122931"</span>, <span class="st">"169716"</span>, <span class="st">"159656"</span>, <span class="st">"127918"</span>, <span class="st">"192323"</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"163046"</span>, <span class="st">"122612"</span>, <span class="st">"236595"</span>, <span class="st">"239105"</span>, <span class="st">"203368"</span>, <span class="st">"179159"</span>, <span class="st">"215770"</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"215929"</span>, <span class="st">"131496"</span>, <span class="st">"166124"</span>, <span class="st">"102234"</span>, <span class="st">"117946"</span>, <span class="st">"206622"</span>, <span class="st">"102234"</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"166124"</span>, <span class="st">"117946"</span>, <span class="st">"206622"</span>, <span class="st">"235316"</span>, <span class="st">"129242"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First up is USF enrollment from Fall 1987 to Fall 2018 (the latest year that IPEDS had available as of February 2020). The ggplot code is mostly basic, so I’ve folded it…click the arrow to show the code. It’s mostly worth checking out for <a href="https://stackoverflow.com/a/52920047/10226848">this neat solution</a> to a crowded x axis - the <code>every_nth</code> function to count every n value, and apply it to the breaks - in this case I set it to n=3. I’d tried <code>scales::pretty_breaks()</code> but it didn’t work. I also used <code>ggrepel</code> to move the labels a bit.</p>
<p>What’s the enrollment picture at USF? Well, this chart tells us that:</p>
<ul>
<li>Undergraduate enrollment have increased by 60% since 1987.</li>
<li>Graduate enrollments hovering around 3,500 for a number of years, and up to +/- 4,000 since 2016.</li>
<li>Ratio of undergraduate::graduate enrollments steady over time, generally +/- 2% points from 60%.</li>
</ul>
<p>How does this relate to the high school graduation trends in CA &amp; nearby states?</p>
<ul>
<li>With 63% of new students coming from California, high school enrollments here will have most impact.</li>
<li>Western Interstate Commission for Higher Education (WICHE) projects HS grads from all western states to peak in 2024 at 862,000, then decline for a few years, rebounding again around 2032. (Knocking at the College Door, https://knocking.wiche.edu)</li>
<li>During 1980s the Gen X population drop mitigated by increased college-going rates – what will happen this time?</li>
</ul>
<div class="cell" data-fig.dpi="300">
<details>
<summary>show the enrollment charts code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>every_nth <span class="ot">=</span> <span class="cf">function</span>(n) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="cf">function</span>(x) {x[<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="fu">rep</span>(<span class="cn">FALSE</span>, n <span class="sc">-</span> <span class="dv">1</span>))]})</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>plot_usfenr_ug <span class="ot">&lt;-</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    ipeds_fallenroll_8718 <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(UNITID <span class="sc">==</span> <span class="st">"122612"</span>, level <span class="sc">==</span> <span class="st">"Undergraduate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(year, level, tot_enr) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, tot_enr)) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#00543C"</span>) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># geom_text(aes(label = scales::comma(round(tot_enr), accuracy = 1)), </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#                   color = "#919194", vjust = -.75, size = 3) +</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">data =</span> ipeds_fallenroll_8718 <span class="sc">%&gt;%</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">filter</span>(UNITID <span class="sc">==</span> <span class="st">"122612"</span>, level <span class="sc">==</span> <span class="st">"Undergraduate"</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>                                        year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fall 1987"</span>, <span class="st">"Fall 1990"</span>, <span class="st">"Fall 1990"</span>, </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Fall 1993"</span>, <span class="st">"Fall 1996"</span>, <span class="st">"Fall 1999"</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Fall 2002"</span>, <span class="st">"Fall 2005"</span>, <span class="st">"Fall 2008"</span>, <span class="st">"Fall 2011"</span>, </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Fall 2014"</span>, <span class="st">"Fall 2017"</span>, <span class="st">"Fall 2018"</span>)),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">round</span>(tot_enr), </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">accuracy =</span> <span class="dv">1</span>)), <span class="at">nudge_y =</span> <span class="dv">400</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">min.segment.length =</span> <span class="dv">0</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#919194"</span>) <span class="sc">+</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">breaks =</span> <span class="fu">every_nth</span>(<span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7000</span>),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1750</span>, <span class="dv">3500</span>, <span class="dv">5250</span>, <span class="dv">7000</span>)) <span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),   <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>plot_usfenr_gr <span class="ot">&lt;-</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    ipeds_fallenroll_8718 <span class="sc">%&gt;%</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(UNITID <span class="sc">==</span> <span class="st">"122612"</span>, level <span class="sc">==</span> <span class="st">"Graduate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(year, level, tot_enr) <span class="sc">%&gt;%</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, tot_enr)) <span class="sc">+</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"#FDBB30"</span>) <span class="sc">+</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_repel</span>(<span class="at">data =</span> ipeds_fallenroll_8718 <span class="sc">%&gt;%</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">filter</span>(UNITID <span class="sc">==</span> <span class="st">"122612"</span>, level <span class="sc">==</span> <span class="st">"Graduate"</span>,</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>                                     year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fall 1987"</span>, <span class="st">"Fall 1990"</span>, <span class="st">"Fall 1990"</span>, </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Fall 1993"</span>, <span class="st">"Fall 1996"</span>, <span class="st">"Fall 1999"</span>,</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Fall 2002"</span>, <span class="st">"Fall 2005"</span>, <span class="st">"Fall 2008"</span>, <span class="st">"Fall 2011"</span>, </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Fall 2014"</span>, <span class="st">"Fall 2017"</span>, <span class="st">"Fall 2018"</span>)),</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">round</span>(tot_enr), </span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>                                                            <span class="at">accuracy =</span> <span class="dv">1</span>)), <span class="at">nudge_y =</span> <span class="dv">200</span>,</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">min.segment.length =</span> <span class="dv">0</span>,</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#919194"</span>) <span class="sc">+</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">breaks =</span> <span class="fu">every_nth</span>(<span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4500</span>),</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1500</span>, <span class="dv">3000</span>, <span class="dv">4500</span>)) <span class="sc">+</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),   <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>plot_usfenr_all <span class="ot">&lt;-</span> plot_usfenr_ug <span class="sc">+</span> plot_usfenr_gr <span class="sc">+</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">plot_annotation</span>(</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">'Fall Enrollment at USF: 1987 - 2018'</span>,</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"&lt;span style = 'color:#00543C;'&gt;Green = Undergraduate&lt;/span&gt;, </span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;span style = 'color:#FDBB30;'&gt;Gold = Graduate&lt;/span&gt;"</span>,</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Sources: Delta Cost Project &amp; IPEDS"</span>, </span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_markdown</span>(<span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">size =</span> <span class="dv">9</span>)))</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>plot_usfenr_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="images/dataviz2-1.png" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<p>Quick note about this plot…I was getting an annoying <em>Error in grid.Call(C_textBounds, as.graphicsAnnot(x<span class="math inline">\(label), x\)</span>x, x$y, : polygon edge not found</em> message trying to run these plots. For the presentation I was using the Calibri font, with this call in the <code>theme()</code> section: <code>text = element_text(family = "Calibri")</code>. I removed that &amp; the error went away. But this after trying everything from reinstalling Quartz, shutting down all browser windows, running `dev.off()’ in the console…got rid of the special font &amp; no error.</p>
<p>Anyway…back to the charts.</p>
<p>I wanted to show USF undergraduate enrollment indexed over time relative to their Jesuit college peers. The final version of the chart is below, complete with annotations I added in power point. There are ways to do similar annotations on r; I used power point because I could do it quicker, with less fuzting around with annotation placement after rendering and saving the image.</p>
<p>We see that USF is in the upper quarter of total enrollment growth. Gonzaga &amp; St.&nbsp;Louis University, two schools well-known thanks to success in the NCAA men’s basketball tournament, showed significant growth in the period. Here you might say <em>“but wait, Georgetown has had NCAA success”</em>, and I’d reply <em>“yes, but their success started before 1987, so within this period didn’t grow as much as Gonzaga &amp; St.&nbsp;Louis”.</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="jesuitcoll_annotated.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Jesuit College Enrollment</figcaption><p></p>
</figure>
</div>
<p>So how did I make this chart? How did we get the green line for USF, with all else in gray?</p>
<p>First I created a dataframe of the Jesuit colleges, and indexed changes in enrollment to 1.</p>
<div class="cell" data-fig.dpi="300">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>enrollindex_jes <span class="ot">&lt;-</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ipeds_fallenroll_8718 <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(jescoll <span class="sc">==</span> <span class="dv">1</span>, level <span class="sc">==</span> <span class="st">"Undergraduate"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">enr_pct_change2 =</span> enr_pct_change <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">enr_pct_change2 =</span> <span class="fu">ifelse</span>(year <span class="sc">==</span> <span class="st">"Fall 1987"</span>, <span class="dv">1</span>, enr_pct_change2)) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(UNITID, year) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(UNITID) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>(year <span class="sc">&gt;=</span> <span class="st">"Fall 1988"</span>, <span class="fu">cumsum</span>(enr_pct_change2),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                                                                 index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="do">## fix loyola NO b/c of enroll drop after katrina</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="st">"Fall 2006"</span>), </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fl">0.833399497</span>, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2007"</span>),</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2008"</span>),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2009"</span>),</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2010"</span>),</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2011"</span>),</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2012"</span>),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2013"</span>),</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2014"</span>),</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2015"</span>),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2016"</span>),</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2017"</span>),</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">index_enr_inst =</span> <span class="fu">ifelse</span>((UNITID <span class="sc">==</span> <span class="st">"159656"</span> <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> <span class="st">"Fall 2018"</span>),</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>                <span class="fu">lag</span>(index_enr_inst) <span class="sc">+</span> enr_pct_change2, index_enr_inst)) <span class="sc">%&gt;%</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(UNITID, inst_name, year, tot_enr, enr_change, enr_pct_change, </span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>                 enr_pct_change2, index_enr_inst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Why all the manual fixes to Loyola in New Orleans? Well, look at the chart again. See the dip in enrollment around 2005? What might have tanked enrollment at a New Orleans-based college in 2005? Oh right…Hurricane Katrina. To smooth out the drop, I reindexed from the 2006 enrollment point, and added to the index sum after that. For some reason I couldn’t identify, the usual lag from prior year wasn’t working so I just did it manually.</p>
<p>As for the plot…to get the green line, I first plotted everything <em>but</em> USF in grey, then plotted USF in green. Saved the plot, then added annotations in power point.</p>
<div class="cell" data-evaluate="false">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(enrollindex_jes, <span class="fu">aes</span>(year, index_enr_inst, <span class="at">group =</span> UNITID)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(enrollindex_jes, UNITID <span class="sc">!=</span> <span class="st">"122612"</span>), <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">subset</span>(enrollindex_jes, UNITID <span class="sc">==</span> <span class="st">"122612"</span>), </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"#00543C"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">5</span>, <span class="dv">2</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">5</span>, <span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="co">#text = element_text(family = "Calibri"),</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I had planned to use the Delta Cost/IPEDS tuition &amp; fees data for some charts in the section on affordability, but it worked out better to pull data from the College Board.</p>
<p>Again, you can access the presentation in <a href="https://github.com/greg-dubrow/USF-talk-February-2020">the github repo</a>. If you have questions or comments about the code or the content, you can find me on LinkedIn or Twitter by clicking on the icon links at the bottom of the post or on the main page. Or send me an email if you already know how to find me that way.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://www.quarto.org">Built with Quarto</a>
  </li>  
</ul>
    </div>   
      <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../license.html">License</a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>